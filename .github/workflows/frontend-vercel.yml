name: Deploy Frontend to Vercel


on:
push:
branches: [ main ]
paths: [ 'client/**' ]
workflow_dispatch:


jobs:
deploy:
runs-on: ubuntu-latest
environment: production
concurrency:
group: frontend-vercel-prod
cancel-in-progress: true
defaults:
run:
working-directory: client
steps:
- uses: actions/checkout@v4
- uses: actions/setup-node@v4
with:
node-version: 20
cache: npm
cache-dependency-path: client/package-lock.json
- run: npm ci
- run: npm run build
- name: Deploy with Vercel CLI
env:
VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
run: |
npm i -g vercel@latest
vercel pull --yes --environment=production --token=$VERCEL_TOKEN
vercel build --prod --token=$VERCEL_TOKEN
vercel deploy --prebuilt --prod --token=$VERCEL_TOKEN